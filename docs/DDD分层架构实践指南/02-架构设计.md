# 2. 架构设计

## 2.1 四层架构模型

DDD分层架构采用经典的四层模型，每层都有明确的职责和边界：

```
┌─────────────────────────────────────┐
│           接口层 (Interfaces)        │  ← 用户交互、API接口
├─────────────────────────────────────┤
│           应用层 (Application)       │  ← 业务流程编排、事务控制
├─────────────────────────────────────┤
│            领域层 (Domain)           │  ← 核心业务逻辑、业务规则
├─────────────────────────────────────┤
│         基础设施层 (Infrastructure)   │  ← 技术实现、外部依赖
└─────────────────────────────────────┘
```

**架构特点：**
- **清晰的职责分离**：每层专注于特定的关注点
- **依赖方向控制**：高层不依赖低层的具体实现
- **业务逻辑隔离**：核心业务逻辑与技术实现分离
- **可测试性**：每层都可以独立进行单元测试

**依赖规则：**
- **接口层** → 应用层：调用应用服务，不直接访问领域层或基础设施层
- **应用层** → 领域层：编排领域服务和聚合，通过接口访问基础设施层
- **领域层** → 无依赖：纯业务逻辑，不依赖任何外部框架
- **基础设施层** → 领域层：实现领域层定义的接口（依赖倒置）

**典型调用流程：**

```
用户请求 → Controller → Application Service → Domain Service/Entity → Repository Interface → Repository Implementation
```

**详细流程：**
1. **用户发起请求**：通过HTTP请求到达Controller
2. **接口层处理**：Controller验证参数，转换DTO
3. **应用层编排**：Application Service编排业务流程
4. **领域层执行**：Domain Service或Entity执行业务逻辑
5. **数据层访问**：通过Repository接口访问数据
6. **基础设施实现**：Repository Implementation执行具体数据操作
7. **结果返回**：逐层返回结果，最终响应用户

## 2.2 项目结构

### 2.2.1 单体项目结构

基于DDD分层架构的标准项目结构，支持多领域场景下的"领域+分层"组织方式：

```
src/
├── main/
│   ├── java/
│   │   └── com/example/app/
│   │       ├── AppApplication.java                    # 应用启动类
│   │       │
│   │       ├── user/                                  # 用户领域
│   │       │   ├── interfaces/                        # 用户接口层 - 负责与外部系统交互
│   │       │   │   ├── web/                           # Web控制器 - 处理HTTP请求
│   │       │   │   │   ├── UserController.java        # 用户管理控制器
│   │       │   │   │   └── UserProfileController.java # 用户资料控制器
│   │       │   │   ├── dto/                           # 数据传输对象 - 定义接口数据结构
│   │       │   │   │   ├── request/                   # 请求DTO
│   │       │   │   │   │   ├── CreateUserRequest.java # 创建用户请求
│   │       │   │   │   │   ├── UpdateUserRequest.java # 更新用户请求
│   │       │   │   │   │   └── UserQueryRequest.java  # 查询用户请求
│   │       │   │   │   └── response/                  # 响应DTO
│   │       │   │   │       ├── UserResponse.java      # 用户信息响应
│   │       │   │   │       └── UserProfileResponse.java # 用户资料响应
│   │       │   │   ├── assembler/                     # DTO转换器 - 负责DTO与领域对象转换
│   │       │   │   │   └── UserAssembler.java         # 用户对象组装器
│   │       │   │   ├── api/                           # API接口定义(如有)
│   │       │   │   │   └── UserApi.java               # 用户API接口
│   │       │   │   └── advice/                        # 控制器增强 - 处理异常、日志等
│   │       │   │       └── UserControllerAdvice.java  # 用户控制器增强
│   │       │   ├── application/                       # 用户应用层 - 协调领域对象完成业务用例
│   │       │   │   ├── service/                       # 应用服务 - 实现业务用例
│   │       │   │   │   ├── UserApplicationService.java # 用户应用服务
│   │       │   │   │   └── UserQueryService.java      # 用户查询服务
│   │       │   │   ├── command/                       # 命令对象 - 封装业务操作参数
│   │       │   │   │   ├── CreateUserCommand.java     # 创建用户命令
│   │       │   │   │   ├── UpdateUserCommand.java     # 更新用户命令
│   │       │   │   │   └── DeleteUserCommand.java     # 删除用户命令
│   │       │   │   ├── query/                         # 查询对象 - 封装查询参数
│   │       │   │   │   └── UserQuery.java             # 用户查询对象
│   │       │   │   ├── event/                         # 应用事件处理 - 处理领域事件
│   │       │   │   │   └── UserCreatedEventHandler.java # 用户创建事件处理器
│   │       │   │   └── apiResponse/                        # 应用结果对象 - 返回应用层结果
│   │       │   │       └── UserResult.java            # 用户结果对象
│   │       │   ├── domain/                            # 用户领域核心 - 包含核心业务逻辑
│   │       │   │   ├── model/                         # 领域模型 - 业务核心概念
│   │       │   │   │   ├── aggregate/                 # 聚合根 - 实体和值对象的集合
│   │       │   │   │   │   └── User.java              # 用户聚合根
│   │       │   │   │   └── entity/                    # 实体 - 有唯一标识的对象
│   │       │   │   │       └── UserProfile.java       # 用户资料实体
│   │       │   │   ├── valueobject/                   # 值对象 - 无唯一标识的对象
│   │       │   │   │   ├── PhoneNumber.java           # 电话号码值对象 - 复杂业务概念才使用值对象
│   │       │   │   │   └── Email.java                 # 邮箱值对象
│   │       │   │   ├── service/                       # 领域服务 - 不属于实体的业务逻辑
│   │       │   │   │   ├── UserDomainService.java     # 用户领域服务
│   │       │   │   │   └── PasswordService.java       # 密码服务
│   │       │   │   ├── repository/                    # 仓储接口 - 持久化领域对象
│   │       │   │   │   └── UserRepository.java        # 用户仓储接口
│   │       │   │   ├── factory/                       # 工厂 - 创建复杂领域对象
│   │       │   │   │   └── UserFactory.java           # 用户工厂
│   │       │   │   └── event/                         # 领域事件 - 领域模型状态变化通知
│   │       │   │       ├── UserCreatedEvent.java      # 用户创建事件
│   │       │   │       └── UserUpdatedEvent.java      # 用户更新事件
│   │       │   └── infrastructure/                    # 用户基础设施层 - 提供技术实现
│   │       │       ├── persistence/                   # 持久化实现 - 数据访问实现
│   │       │       │   ├── repository/                # 仓储实现 - 实现领域仓储接口
│   │       │       │   │   └── UserRepositoryImpl.java # 用户仓储实现
│   │       │       │   ├── mapper/                    # MyBatis映射器 - 数据库访问接口
│   │       │       │   │   └── UserMapper.java        # 用户Mapper
│   │       │       │   ├── po/                        # 持久化对象 - 映射数据库表结构
│   │       │       │   │   ├── UserPO.java            # 用户持久化对象
│   │       │       │   │   └── UserProfilePO.java     # 用户资料持久化对象
│   │       │       │   └── converter/                 # 转换器 - 领域对象与PO转换
│   │       │       │       └── UserConverter.java     # 用户转换器
│   │       │       ├── external/                      # 外部服务 - 集成外部系统
│   │       │       │   ├── UserNotificationService.java # 用户通知服务
│   │       │       │   └── ThirdPartyUserService.java # 第三方用户服务
│   │       │       ├── config/                        # 配置 - 模块特定配置
│   │       │       │   └── UserConfig.java            # 用户模块配置
│   │       │       └── cache/                         # 缓存 - 数据缓存实现
│   │       │           ├── UserCacheService.java      # 用户缓存服务
│   │       │           └── UserCacheKeyGenerator.java # 用户缓存键生成器
│   │       │
│   │       ├── order/                                 # 订单领域(示例) - 完整的订单上下文
│   │       │   ├── interfaces/                        # 订单接口层
│   │       │   │   ├── web/                           # Web控制器
│   │       │   │   │   └── OrderController.java       # 订单控制器
│   │       │   │   └── dto/                           # 数据传输对象
│   │       │   │       ├── request/                   # 请求DTO
│   │       │   │       └── response/                  # 响应DTO
│   │       │   ├── application/                       # 订单应用层
│   │       │   │   ├── service/                       # 应用服务
│   │       │   │   │   └── OrderApplicationService.java # 订单应用服务
│   │       │   │   └── command/                       # 命令对象
│   │       │   │       └── CreateOrderCommand.java    # 创建订单命令
│   │       │   ├── domain/                            # 订单领域层
│   │       │   │   ├── model/                         # 领域模型
│   │       │   │   │   ├── aggregate/                 # 聚合根
│   │       │   │   │   │   └── Order.java             # 订单聚合根
│   │       │   │   │   └── entity/                    # 实体
│   │       │   │   │       └── OrderItem.java         # 订单项实体
│   │       │   │   └── service/                       # 领域服务
│   │       │   │       └── OrderDomainService.java    # 订单领域服务
│   │       │   └── infrastructure/                    # 订单基础设施层
│   │       │       ├── persistence/                   # 持久化实现
│   │       │       │   ├── repository/                # 仓储实现
│   │       │       │   └── mapper/                    # MyBatis映射器
│   │       │       └── external/                      # 外部服务
│   │       │
│   │       └── shared/                                # 共享层 - 跨领域共享组件
│   │           ├── domain/                            # 共享领域组件 - 跨领域的领域概念
│   │           │   ├── valueobject/                   # 共享值对象 - 跨领域使用的值对象
│   │           │   │   └── Address.java               # 地址值对象
│   │           │   ├── entity/                        # 共享实体基类 - 实体通用行为
│   │           │   │   ├── BaseEntity.java            # 实体基类
│   │           │   │   └── AggregateRoot.java         # 聚合根基类
│   │           │   └── event/                         # 共享事件 - 领域事件基础设施
│   │           │       ├── DomainEvent.java           # 领域事件接口
│   │           │       ├── BaseDomainEvent.java       # 领域事件基类
│   │           │       └── DomainEventPublisher.java  # 领域事件发布器
│   │           ├── application/                       # 共享应用组件 - 跨应用层组件
│   │           │   ├── dto/                           # 共享DTO - 通用数据传输对象
│   │           │   │   └── ApiResponse.java           # 统一响应对象
│   │           │   └── service/                       # 共享应用服务 - 跨领域应用服务
│   │           │       ├── NotificationService.java   # 通知服务
│   │           │       └── IdGeneratorService.java    # ID生成服务
│   │           ├── infrastructure/                    # 共享基础设施 - 技术基础组件
│   │           │   ├── persistence/                   # 共享持久化组件 - 数据访问基础组件
│   │           │   │   ├── BaseMapper.java            # 基础Mapper接口
│   │           │   │   ├── BaseRepository.java        # 基础仓储接口
│   │           │   │   └── BaseRepositoryImpl.java    # 基础仓储实现
│   │           │   ├── cache/                         # 缓存组件 - 缓存基础设施
│   │           │   │   ├── CacheManager.java          # 缓存管理器
│   │           │   │   └── RedisCacheManager.java     # Redis缓存管理器
│   │           │   ├── security/                      # 安全组件 - 认证授权基础设施
│   │           │   │   ├── SecurityContext.java       # 安全上下文
│   │           │   │   ├── SecurityUtils.java         # 安全工具类
│   │           │   │   └── JwtTokenProvider.java      # JWT令牌提供者
│   │           │   └── messaging/                     # 消息组件 - 消息通信基础设施
│   │           │       ├── MessagePublisher.java      # 消息发布器
│   │           │       ├── MessageSubscriber.java     # 消息订阅器
│   │           │       └── KafkaMessagePublisher.java # Kafka消息发布器
│   │           ├── exception/                         # 异常处理 - 全局异常定义和处理
│   │           │   ├── BusinessException.java         # 业务异常
│   │           │   ├── DomainException.java           # 领域异常
│   │           │   ├── InfrastructureException.java   # 基础设施异常
│   │           │   ├── ApplicationException.java      # 应用层异常
│   │           │   └── GlobalExceptionHandler.java    # 全局异常处理器
│   │           ├── constant/                          # 常量定义 - 全局常量
│   │           │   ├── ErrorCode.java                 # 错误码
│   │           │   ├── BusinessConstant.java          # 业务常量
│   │           │   └── SystemConstant.java            # 系统常量
│   │           ├── annotation/                        # 自定义注解 - 框架扩展点
│   │           │   ├── DomainService.java             # 领域服务注解
│   │           │   ├── ApplicationService.java        # 应用服务注解
│   │           │   ├── ReadOnly.java                  # 只读操作注解
│   │           │   └── Audit.java                     # 审计注解
│   │           └── base/                              # 基础类 - 基础抽象类
│   │               ├── BaseEntity.java                # 实体基类
│   │               ├── BaseValueObject.java           # 值对象基类
│   │               ├── BaseRepository.java            # 仓储基类
│   │               └── BaseController.java            # 控制器基类
│   │
│   └── resources/
│       ├── application.yml                            # 主配置文件
│       ├── application-dev.yml                        # 开发环境配置
│       ├── application-test.yml                       # 测试环境配置
│       ├── application-prod.yml                       # 生产环境配置
│       ├── sql/                                        # 数据库脚本
│       └── messages/                                  # 国际化资源
│           ├── messages.properties                    # 默认消息
│           ├── messages_en.properties                 # 英文消息
│           └── messages_zh_CN.properties              # 中文消息
```

**项目结构设计原则：**
1. **领域+分层组织**：多领域场景下，按"领域+DDD分层"方式组织包结构，每个领域内部完整实现DDD四层架构
2. **共享组件分离**：分页对象、统一响应对象等共享组件放在shared层，避免重复定义
3. **值对象按需设计**：避免过度设计，简单的字符串类型（如email、id）可直接使用基本类型，复杂的业务概念才使用值对象，是否创建值对象由开发者来判定和决定。
4. **严格的分层隔离**：每层都有明确的边界，不允许跨层直接访问
5. **接口与实现分离**：领域层定义接口，基础设施层提供实现
6. **配置外部化**：所有配置都放在resources目录下，支持多环境
7. **资源按领域分类**：XML映射文件等资源按领域分类存放

### 2.2.2 微服务项目结构

在微服务架构中，每个服务都是一个独立的DDD应用，遵循分层架构。服务之间通过API网关进行通信，共享的领域模型和基础设施可以提取为公共库。

```
project/
├── project-shared/                # 共享模块
│   ├── project-shared-domain/     # 共享领域模型
│   │   ├── src/main/java/
│   │   │   └── com/example/shared/domain/
│   │   │       ├── valueobject/   # 共享值对象
│   │   │       ├── event/         # 共享领域事件
│   │   │       └── exception/     # 共享领域异常
│   ├── project-shared-application/ # 共享应用层组件
│   │   ├── src/main/java/
│   │   │   └── com/example/shared/application/
│   │   │       ├── dto/           # 共享DTO
│   │   │       └── command/       # 共享命令
│   └── project-shared-infrastructure/ # 共享基础设施
│       ├── src/main/java/
│       │   └── com/example/shared/infrastructure/
│       │       ├── persistence/   # 共享持久化组件
│       │       ├── messaging/     # 共享消息组件
│       │       ├── security/      # 共享安全组件
│       │       └── util/          # 共享工具类
├── project-user/                  # 用户服务
│   ├── project-user-api/          # 用户服务API模块
│   │   ├── src/main/java/
│   │   │   └── com/example/user/api/
│   │   │       ├── dto/           # API数据传输对象
│   │   │       ├── client/        # Feign客户端
│   │   │       └── fallback/      # 服务降级处理
│   └── project-user-service/      # 用户服务实现模块
│       ├── src/main/java/
│       │   └── com/example/user/
│       │       ├── interfaces/    # 接口层
│       │       ├── application/   # 应用层
│       │       ├── domain/        # 领域层
│       │       └── infrastructure/ # 基础设施层
│       └── src/main/resources/
│           └── application.yml
├── project-order/                 # 订单服务
│   ├── project-order-api/         # 订单服务API模块
│   └── project-order-service/     # 订单服务实现模块
├── project-gateway/               # API网关服务
│   ├── src/main/java/
│   │   └── com/example/gateway/
│   │       ├── filter/            # 网关过滤器
│   │       ├── config/            # 网关配置
│   │       └── security/          # 安全配置
│   └── src/main/resources/
│       └── application.yml
├── project-auth/                  # 认证授权服务
│   ├── src/main/java/
│   │   └── com/example/auth/
│   └── src/main/resources/
├── project-config/                # 配置服务
│   ├── src/main/java/
│   │   └── com/example/config/
│   └── src/main/resources/
│       └── config/                # 集中配置文件
└── project-registry/              # 服务注册中心
    ├── src/main/java/
    │   └── com/example/registry/
    └── src/main/resources/
```

## 2.3 分层职责

### 2.3.1 接口层 (Interfaces Layer)

**核心职责：**
- 处理HTTP请求和响应
- 数据格式转换（DTO ↔ Domain Object）
- 输入验证和参数校验
- 异常处理和错误响应
- 国际化消息处理
- API文档生成

**主要组件：**
- **Controller**：REST API 控制器，处理HTTP请求
- **DTO**：数据传输对象，定义API的输入输出格式
- **Assembler**：DTO 与领域对象的转换器
- **Facade**：为复杂操作提供简化接口

**设计原则：**
- 薄接口层：不包含业务逻辑，只负责协议转换
- 统一响应格式：所有API返回统一的响应结构
- 完整的输入验证：确保数据的有效性和安全性

### 2.3.2 应用层 (Application Layer)

**核心职责：**
- 业务流程编排和协调
- 事务边界控制
- 权限验证和安全控制
- 应用事件发布和处理
- 缓存管理
- 外部服务调用协调

**主要组件：**
- **Application Service**：应用服务，编排业务流程
- **Command**：命令对象，封装操作请求
- **Query**：查询对象，封装查询请求
- **Event Handler**：应用事件处理器
- **Cache Service**：缓存服务

**设计原则：**
- 无状态服务：应用服务不保存状态信息
- 事务边界：在应用层控制事务的开始和结束
- 编排不实现：编排领域服务，不实现具体业务逻辑

### 2.3.3 领域层 (Domain Layer)

**核心职责：**
- 核心业务逻辑实现
- 业务规则和约束
- 领域模型定义
- 业务不变性保证
- 领域事件定义和发布

**主要组件：**
- **Entity**：领域实体，具有唯一标识的业务对象
- **Value Object**：值对象，通过属性值区分的对象
- **Domain Service**：领域服务，跨实体的业务逻辑
- **Repository Interface**：仓储接口，定义数据访问契约
- **Factory**：领域对象工厂，负责复杂对象的创建
- **Domain Event**：领域事件，表示业务中的重要事件

**设计原则：**
- 业务逻辑纯净：不依赖任何技术框架
- 充血模型：实体包含业务行为，不仅仅是数据容器
- 不变性保证：通过业务规则维护数据一致性

### 2.3.4 基础设施层 (Infrastructure Layer)

**核心职责：**
- 数据持久化实现
- 外部服务集成
- 技术框架配置
- 横切关注点实现
- 国际化和时区支持
- 消息队列集成

**主要组件：**
- **Repository Implementation**：仓储实现，具体的数据访问逻辑
- **MyBatis Plus Mapper**：数据访问映射
- **DataObject (DO)**：数据库实体对象，对应数据库表结构
- **Converter**：领域对象与数据库实体的转换器
- **External Service**：外部服务客户端
- **Configuration**：技术配置类
- **I18n Support**：国际化支持

**命名约定说明：**
- **领域层Entity**：领域实体，包含业务逻辑和业务规则，如 `User`、`Order`
- **基础设施层DataObject**：数据库实体对象，纯数据结构，如 `UserDO`、`OrderDO`
- 这样命名可以避免混淆，清晰区分业务模型和数据模型

**设计原则：**
- 实现抽象：实现领域层定义的接口
- 技术隔离：将技术细节封装在基础设施层
- 可替换性：支持不同技术实现的替换

### 2.3.5 领域Entity vs 数据库DataObject

为了避免混淆，我们需要明确区分领域层的Entity和基础设施层的DataObject：

| 对比维度 | 领域层Entity | 基础设施层DataObject |
|---------|-------------|-------------------|
| **命名约定** | `User`、`Order`、`Product` | `UserDO`、`OrderDO`、`ProductDO` |
| **核心职责** | 业务逻辑和业务规则 | 数据持久化映射 |
| **包含内容** | 业务方法、验证逻辑、不变性保证 | 数据字段、数据库注解 |
| **依赖关系** | 不依赖任何技术框架 | 依赖MyBatis Plus、数据库 |
| **生命周期** | 由业务逻辑驱动 | 由数据访问驱动 |
| **变更原因** | 业务需求变化 | 数据库结构变化 |

**示例对比：**

```java
// 领域层Entity - 包含业务逻辑
public class User extends AggregateRoot<ID> {
    private ID id;
    private String username;
    private String email;
    private UserStatus status;
    
    // 业务方法
    public void activate() {
        if (this.status == UserStatus.DELETED) {
            throw new DomainException("已删除用户无法激活");
        }
        this.status = UserStatus.ACTIVE;
        // 发布领域事件
        addDomainEvent(new UserActivatedEvent(this.id));
    }
    
    public void changeEmail(String newEmail) {
        // 业务规则验证
        if (this.status != UserStatus.ACTIVE) {
            throw new DomainException("非活跃用户无法修改邮箱");
        }
        this.email = newEmail;
    }
}

// 基础设施层DataObject - 纯数据结构
@TableName("users")
public class UserDO {
    @TableId(type = IdType.ASSIGN_UUID)
    private String id;
    
    @TableField("username")
    private String username;
    
    @TableField("email")
    private String email;
    
    @TableField("status")
    private String status;
    
    @TableField("created_at")
    private LocalDateTime createdAt;
    
    @TableField("updated_at")
    private LocalDateTime updatedAt;
    
    // 只有getter/setter，无业务逻辑
}
```

**转换关系：**
- 通过Converter在领域Entity和DataObject之间进行转换
- 领域层不知道DataObject的存在
- 基础设施层负责两者之间的映射

## 2.4 最佳实践

### 2.4.1 依赖管理原则

**1. 严格的分层依赖**
- 接口层 → 应用层 → 领域层
- 基础设施层 → 领域层（实现仓储接口）
- 禁止跨层调用和循环依赖

**2. 依赖倒置原则**
- 高层模块不依赖低层模块
- 抽象不依赖具体实现
- 具体实现依赖抽象

**3. 接口隔离原则**
- 为不同的客户端定义不同的接口
- 避免胖接口，保持接口的单一职责

### 2.4.2 事务控制策略

**事务边界原则：**
- 在应用层控制事务边界
- 一个应用服务方法对应一个事务
- 避免跨应用服务的事务

**事务配置最佳实践：**
```java
@Service
@Transactional(readOnly = true)  // 默认只读事务
public class UserApplicationService {
    
    @Transactional(rollbackFor = Exception.class)  // 写操作事务
    public UserDTO createUser(CreateUserCommand command) {
        // 业务逻辑实现
    }
}
```

## 3. 技术栈

**核心框架：**
- **Java 17+**：使用最新的Java特性，如记录类、模式匹配等
- **Spring Boot 3.5+**：主框架，提供依赖注入和自动配置
- **Spring Security 6.x**：安全框架，处理认证和授权
- **MyBatis Plus 3.x**：数据访问层ORM框架，提供强大的查询能力

**数据存储：**
- **MySQL 8.0**：主数据库，支持JSON字段和窗口函数。使用 mysql-connector-j jdbc 驱动。
- **HikariCP**：高性能数据库连接池
- **Redis 7.x**：缓存和会话存储，支持多种数据结构
- **Elasticsearch**：搜索引擎，用于复杂查询和全文搜索

**构建和部署：**
- **Maven 3.9+**：构建工具和依赖管理
- **Docker**：容器化部署
- **Docker Compose**：本地开发环境编排

**监控和运维：**
- **Spring Boot Actuator**：应用监控和健康检查
- **Micrometer**：指标收集
- **Logback**：日志框架

**测试框架：**
- **JUnit 5**：单元测试框架，支持参数化测试和动态测试
- **Mockito 5.x**：模拟框架，用于创建测试替身
- **AssertJ**：流式断言库，提供更好的测试可读性
- **TestContainers**：集成测试容器，支持真实数据库和中间件测试
- **Spring Boot Test**：Spring Boot测试支持，包含各种测试切片
- **WireMock**：HTTP服务模拟，用于外部API测试
- **Testcontainers-JUnit5**：JUnit5与TestContainers集成

**开发工具：**
- **Lombok**：减少样板代码，自动生成getter/setter等
- **Spring Boot DevTools**：开发时热重载和自动重启
- **Swagger/OpenAPI 3**：API文档生成和在线测试
- **Spring Boot Configuration Processor**：配置元数据生成
- **MapStruct**：对象映射工具，编译时生成映射代码
- **Spotless**：代码格式化工具，保持代码风格一致
- **ArchUnit**：架构测试工具，验证架构规则

**工具库：**
- **Apache Commons Lang3**：通用工具类库
- **Jackson**：JSON序列化和反序列化
- **Validation API**：参数校验
- **Guava**：Google核心库，提供集合、缓存、并发等工具

**禁止使用的依赖：**
- **Hutool**：避免过度依赖工具库，保持代码的可控性
- **Fastjson**：存在安全风险，使用Jackson替代
- **Spring Data JPA**：与MyBatis Plus冲突，统一使用MyBatis Plus
- **Apache Commons BeanUtils**：性能较差，使用MapStruct替代
- **Dozer**：映射性能差，使用MapStruct替代
- **ModelMapper**：运行时映射，性能不如编译时的MapStruct
- **Gson**：功能不如Jackson完善，统一使用Jackson
- **Log4j 1.x**：已停止维护且存在安全漏洞，使用Logback
- **Commons Logging**：桥接复杂，直接使用SLF4J
- **Quartz**：过于重量级，简单任务使用Spring Task
- **Ehcache 2.x**：版本过旧，使用Caffeine或Redis
- **Jedis**：连接池管理复杂，使用Spring Data Redis
- **HttpClient 4.x**：版本过旧，使用Spring WebClient或OkHttp
- **Swagger 2.x**：已过时，使用OpenAPI 3
- **JUnit 4**：功能有限，使用JUnit 5
- **Hamcrest**：断言不够流畅，使用AssertJ
- **PowerMock**：与现代JVM不兼容，重构代码以支持Mockito